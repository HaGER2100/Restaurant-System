<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Food&Drink</title>

    <!-- bootstrap icons  -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
      integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
    <!-- bootstrap -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC"
      crossorigin="anonymous"
    />
    <!-- main style -->
    <link rel="stylesheet" href="../content/css/index.css" />
  </head>
  <body>
    <div class="page d-flex">
      <div class="sidebar bg-white">
        <h3 class="p-relative txt-c mt-0">
          Smart<span style="color: #cb161d">pos</span>
        </h3>
        <ul>
          <li>
            <a
              class="active d-flex align-center fs-14 c-black rad-6"
              href="./Dashboard.html"
            >
              <i class="fa-regular fa-chart-bar fa-fw"></i>
              <span>Dashboard</span>
            </a>
          </li>
          <li>
            <a
              class="d-flex align-center fs-14 c-black rad-6"
              href="./Food&Drink.html"
            >
              <i class="fa-solid fa-burger"></i>
              <span>food & Drink</span>
            </a>
          </li>
          <li>
            <a class="d-flex align-center fs-14 c-black rad-6" href="#">
              <i class="fa-solid fa-message"></i>
              <span>Massages</span>
            </a>
          </li>
          <li>
            <a class="d-flex align-center fs-14 c-black rad-6" href="#">
              <i class="fa-solid fa-diagram-project fa-fw"></i>
              <span>Bills</span>
            </a>
          </li>
          <li>
            <a class="d-flex align-center fs-14 c-black rad-6" href="#">
              <i class="fa-solid fa-gear fa-fw"></i>
              <span>Settings</span>
            </a>
          </li>
          <li>
            <a class="d-flex align-center fs-14 c-black rad-6" href="#">
              <i class="fa-solid fa-envelope"></i>
              <span>Notifications</span>
            </a>
          </li>
          <li>
            <a class="d-flex align-center fs-14 c-black rad-6" href="#">
              <i class="fa-solid fa-credit-card fa-fw"></i>
              <span>Support</span>
            </a>
          </li>
        </ul>
      </div>

      <div class="content">
        <!-- Start Head -->
        <div class="head">
          <div class="icons">
            <nav>
              <ol class="breadcrumb">
                <li class="breadcrumb-item">
                  <a href="./Food&Drink.html" class="nothov">Food&Drink</a>
                </li>
                <li class="breadcrumb-item">Categories</li>
              </ol>
            </nav>
          </div>
          <div class="search p-relative">
            <input class="p-10" type="search" placeholder="search..." />
            <span class="notification p-relative">
              <i class="fa-regular fa-clock"></i>
            </span>
            <span class="notification p-relative">
              <i class="fa-regular fa-bell fa-lg"></i>
            </span>
          </div>
        </div>
        <!-- End Head -->

        <!-- Start  -->

        <!-- <div class="containe"> -->
          <main>
            <!-- Start DEMO HTML (Use the following code into your project)-->
            <div class="container">
              <div class="row">
                <div class="col-sm-12 col-md-12 col-lg-6 col-xs-12">
                  <h4 class="badge-pill badge-light mt-3 mb-3 p-2 text-center">
                    Products
                  </h4>
                  <div class="row">
                    <div class="col-sm-6 col-md-6 col-lg-6 ">
                      <div class="shadow-sm card mb-3 product">
                        <img
                          class="product-img"
                          src="../content/images/speciality-2.jpg"
                          alt="prd1"
                          onmouseover="animateImg(this)"
                          onmouseout="normalImg(this)"
                        />
                        <div class="card-body">
                          <h5 class="card-title text-info bold product-name">
                            pizza  Vegetarian
                          </h5>
                          <p class="card-text text-success product-price">
                            100 $
                          </p>
                          <button
                            class="btn badge badge-pill badge-secondary mt-2 float-right"
                            type="button"
                            data-action="add-to-cart"
                          >
                            Add to cart
                          </button>
                        </div>
                      </div>
                    </div>
                    <div class="col-sm-6 col-md-6 col-lg-6 ">
                      <div class="shadow-sm card mb-3 product">
                        <img
                          class="product-img"
                          src="../content/images/pizza-13.jpg"
                          alt="prd2"
                          onmouseover="animateImg(this)"
                          onmouseout="normalImg(this)"
                        />
                        <div class="card-body">
                          <h5 class="card-title text-info product-name">
                            pizza Parmiglana
                          </h5>
                          <p class="card-text text-success product-price">
                           200 $
                          </p>
                          <button
                            class="btn badge badge-pill badge-secondary mt-2 float-right"
                            type="button"
                            data-action="add-to-cart"
                          >
                            Add to cart
                          </button>
                        </div>
                      </div>
                    </div>
                    <div class="col-sm-6 col-md-6 col-lg-6 ">
                      <div class="shadow-sm card mb-3 product">
                        <img
                          class="product-img"
                          src="../content/images/pizza-14.jpg"
                          alt="prd3"
                          onmouseover="animateImg(this)"
                          onmouseout="normalImg(this)"
                        />
                        <div class="card-body">
                          <h5 class="card-title text-info product-name">
                            pizza Four Cheese
                          </h5>
                          <p class="card-text text-success product-price">
                            250 $
                          </p>
                          <button
                            class="btn badge badge-pill badge-secondary mt-2 float-right"
                            type="button"
                            data-action="add-to-cart"
                          >
                            Add to cart
                          </button>
                        </div>
                      </div>
                    </div>
                    <div class="col-sm-6 col-md-6 col-lg-6">
                      <div class="shadow-sm card mb-3 product">
                        <img
                          class="product-img"
                          src="../content/images/pizza-15.jpg"
                          alt="prd3"
                          onmouseover="animateImg(this)"
                          onmouseout="normalImg(this)"
                        />
                        <div class="card-body">
                          <h5 class="card-title text-info product-name">
                            pizza Boscaiola
                          </h5>
                          <p class="card-text text-success product-price">
                           50 $
                          </p>
                          <button
                            class="btn badge badge-pill badge-secondary mt-2 float-right"
                            type="button"
                            data-action="add-to-cart"
                          >
                            Add to cart
                          </button>
                        </div>
                      </div>
                    </div>
                  </div>               
                </div>
                <div class="col-sm-12 col-md-12 col-lg-6 col-xs-12">
                  <h4 class="badge-pill badge-light mt-3 mb-3 p-2 text-center">
                    Cart
                  </h4>
                  <div class="cart"></div>
                </div>
              </div>
            </div>
            <!-- END EDMO HTML (Happy Coding!)-->
          </main>
        </div>

        <!-- End  -->
      </div>
    </div>
    <!-- link -->
    <script>
      "use strict";
      let cart = [];
      let cartTotal = 0;
      const cartDom = document.querySelector(".cart");
      const addtocartbtnDom = document.querySelectorAll(
        '[data-action="add-to-cart"]'
      );

      addtocartbtnDom.forEach((addtocartbtnDom) => {
        addtocartbtnDom.addEventListener("click", () => {
          const productDom = addtocartbtnDom.parentNode.parentNode;
          const product = {
            img: productDom.querySelector(".product-img").getAttribute("src"),
            name: productDom.querySelector(".product-name").innerText,
            price: productDom.querySelector(".product-price").innerText,
            quantity: 1,
          };

          const IsinCart =
            cart.filter((cartItem) => cartItem.name === product.name).length >
            0;
          if (IsinCart === false) {
            cartDom.insertAdjacentHTML(
              "beforeend",
              `
        <div class="d-flex flex-row shadow-sm card cart-items mt-2 mb-3 animated flipInX">
          <div class="p-2">
              <img src="${product.img}" alt="${product.name}" style="max-width: 50px;"/>
          </div>
          <div class="p-2 mt-3">
              <p class="text-info cart_item_name">${product.name}</p>
          </div>
          <div class="p-2 mt-3">
              <p class="text-success cart_item_price">${product.price}</p>
          </div>
          <div class="p-2 mt-3 ml-auto">
              <button class="btn badge badge-secondary" type="button" data-action="increase-item">&plus;
          </div>
          <div class="p-2 mt-3">
            <p class="text-success cart_item_quantity">${product.quantity}</p>
          </div>
          <div class="p-2 mt-3">
            <button class="btn badge badge-info" type="button" data-action="decrease-item">&minus;
          </div>
          <div class="p-2 mt-3">
            <button class="btn badge badge-danger" type="button" data-action="remove-item">&times;
          </div>
        </div> `
            );

            if (document.querySelector(".cart-footer") === null) {
              cartDom.insertAdjacentHTML(
                "afterend",
                `
            <div class="d-flex flex-row shadow-sm card cart-footer mt-2 mb-3 animated flipInX">
              <div class="p-2">
                <button class="btn badge-danger" type="button" data-action="clear-cart">Clear Cart
              </div>
              <div class="p-2 ml-auto">
                <button class="btn badge-dark" type="button" data-action="check-out">Pay <span class="pay"></span> 
                  &#10137;
              </div>
            </div>`
              );
            }

            addtocartbtnDom.innerText = "In cart";
            addtocartbtnDom.disabled = true;
            cart.push(product);

            const cartItemsDom = cartDom.querySelectorAll(".cart-items");
            cartItemsDom.forEach((cartItemDom) => {
              if (
                cartItemDom.querySelector(".cart_item_name").innerText ===
                product.name
              ) {
                cartTotal +=
                  parseInt(
                    cartItemDom.querySelector(".cart_item_quantity").innerText
                  ) *
                  parseInt(
                    cartItemDom.querySelector(".cart_item_price").innerText
                  );
                document.querySelector(".pay").innerText = cartTotal + " Rs.";

                // increase item in cart
                cartItemDom
                  .querySelector('[data-action="increase-item"]')
                  .addEventListener("click", () => {
                    cart.forEach((cartItem) => {
                      if (cartItem.name === product.name) {
                        cartItemDom.querySelector(
                          ".cart_item_quantity"
                        ).innerText = ++cartItem.quantity;
                        cartItemDom.querySelector(
                          ".cart_item_price"
                        ).innerText =
                          parseInt(cartItem.quantity) *
                            parseInt(cartItem.price) +
                          " Rs.";
                        cartTotal += parseInt(cartItem.price);
                        document.querySelector(".pay").innerText =
                          cartTotal + " Rs.";
                      }
                    });
                  });

                // decrease item in cart
                cartItemDom
                  .querySelector('[data-action="decrease-item"]')
                  .addEventListener("click", () => {
                    cart.forEach((cartItem) => {
                      if (cartItem.name === product.name) {
                        if (cartItem.quantity > 1) {
                          cartItemDom.querySelector(
                            ".cart_item_quantity"
                          ).innerText = --cartItem.quantity;
                          cartItemDom.querySelector(
                            ".cart_item_price"
                          ).innerText =
                            parseInt(cartItem.quantity) *
                              parseInt(cartItem.price) +
                            " Rs.";
                          cartTotal -= parseInt(cartItem.price);
                          document.querySelector(".pay").innerText =
                            cartTotal + " Rs.";
                        }
                      }
                    });
                  });

                //remove item from cart
                cartItemDom
                  .querySelector('[data-action="remove-item"]')
                  .addEventListener("click", () => {
                    cart.forEach((cartItem) => {
                      if (cartItem.name === product.name) {
                        cartTotal -= parseInt(
                          cartItemDom.querySelector(".cart_item_price")
                            .innerText
                        );
                        document.querySelector(".pay").innerText =
                          cartTotal + " Rs.";
                        cartItemDom.remove();
                        cart = cart.filter(
                          (cartItem) => cartItem.name !== product.name
                        );
                        addtocartbtnDom.innerText = "Add to cart";
                        addtocartbtnDom.disabled = false;
                      }
                      if (cart.length < 1) {
                        document.querySelector(".cart-footer").remove();
                      }
                    });
                  });

                //clear cart
                document
                  .querySelector('[data-action="clear-cart"]')
                  .addEventListener("click", () => {
                    cartItemDom.remove();
                    cart = [];
                    cartTotal = 0;
                    if (document.querySelector(".cart-footer") !== null) {
                      document.querySelector(".cart-footer").remove();
                    }
                    addtocartbtnDom.innerText = "Add to cart";
                    addtocartbtnDom.disabled = false;
                  });

                document
                  .querySelector('[data-action="check-out"]')
                  .addEventListener("click", () => {
                    if (document.getElementById("paypal-form") === null) {
                      checkOut();
                    }
                  });
              }
            });
          }
        });
      });

      function animateImg(img) {
        img.classList.add("animated", "shake");
      }

      function normalImg(img) {
        img.classList.remove("animated", "shake");
      }

      function checkOut() {
        let paypalHTMLForm = `
        <form id="paypal-form" action="https://www.paypal.com/cgi-bin/webscr" method="post" >
          <input type="hidden" name="cmd" value="_cart">
          <input type="hidden" name="upload" value="1">
          <input type="hidden" name="business" value="gmanish478@gmail.com">
          <input type="hidden" name="currency_code" value="INR">`;

        cart.forEach((cartItem, index) => {
          ++index;
          paypalHTMLForm += ` <input type="hidden" name="item_name_${index}" value="${
            cartItem.name
          }">
          <input type="hidden" name="amount_${index}" value="${cartItem.price.replace(
            "Rs.",
            ""
          )}">
          <input type="hidden" name="quantity_${index}" value="${
            cartItem.quantity
          }">`;
        });

        paypalHTMLForm += `<input type="submit" value="PayPal" class="paypal">
        </form><div class="overlay">Please wait...</div>`;
        document
          .querySelector("body")
          .insertAdjacentHTML("beforeend", paypalHTMLForm);
        document.getElementById("paypal-form").submit();
      }
    </script>
  </body>
</html>
